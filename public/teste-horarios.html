<!DOCTYPE html>
<html>
<head>
    <title>Teste Direto - Horários</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>Teste de Acesso Direto aos Horários</h1>
    
    <div style="padding: 20px; background: #f0f0f0; margin: 20px 0;">
        <h2>Como proceder:</h2>
        <ol>
            <li><strong>Faça login primeiro:</strong> <a href="http://localhost:8000/comerciantes/login" target="_blank">Clique aqui para fazer login</a></li>
            <li><strong>Use estas credenciais:</strong>
                <ul>
                    <li>Email: mazinho@gmail.com</li>
                    <li>Senha: (a senha que você usa)</li>
                </ul>
            </li>
            <li><strong>Após login, acesse diretamente:</strong> <a href="http://localhost:8000/comerciantes/horarios" target="_blank">Sistema de Horários</a></li>
        </ol>
    </div>
    
    <div style="padding: 20px; background: #e7f3ff; margin: 20px 0;">
        <h3>O que foi corrigido:</h3>
        <ul>
            <li>✅ Removido erro do middleware() no controller</li>
            <li>✅ Melhorado método getEmpresaId() para funcionar em vários cenários</li>
            <li>✅ Adicionada verificação de autenticação mais robusta</li>
            <li>✅ Sistema agora funciona independente de seleção de empresa</li>
        </ul>
    </div>
    
    <div style="padding: 20px; background: #fff3cd; margin: 20px 0;">
        <h3>Se ainda redirecionar:</h3>
        <p>O problema pode estar no navegador mantendo histórico. Tente:</p>
        <ul>
            <li>Limpar cache do navegador</li>
            <li>Usar aba anônima/privada</li>
            <li>Fazer logout e login novamente</li>
        </ul>
    </div>
    
    <script>
        // Teste de conectividade
        fetch('http://localhost:8000/comerciantes/horarios')
            .then(response => {
                if (response.ok || response.status === 302) {
                    document.getElementById('status').innerHTML = '✅ Servidor está funcionando!';
                } else {
                    document.getElementById('status').innerHTML = '❌ Problema no servidor';
                }
            })
            .catch(error => {
                document.getElementById('status').innerHTML = '❌ Erro de conexão: ' + error.message;
            });
    </script>
    
    <div id="status" style="padding: 10px; margin: 20px 0; background: #f8f9fa; border: 1px solid #dee2e6;">
        Testando conectividade...
    </div>
</body>
</html>
